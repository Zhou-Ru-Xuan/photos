<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="796" height="396" viewBox="-0.5 -0.5 791 391" content="&lt;mxfile host=&quot;km.sankuai.com&quot; modified=&quot;2021-03-18T11:22:53.785Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.192 Safari/537.36&quot; etag=&quot;FxAe_m4GZMCERtBbpn-l&quot; version=&quot;13.6.2&quot;&gt;&lt;diagram id=&quot;9Ri45IGwRtkMR9vMeX-D&quot; name=&quot;第 1 页&quot;&gt;7Vrfb9sqFP5rkNZJlfzb+NFOk937sGlSH/ZY0Zgk1myTa5Mm3V8/wDi2gSZpFHdt7qpKxR9wwOfjOxxwgTspdl8qtF59JSnOgWOlO+DeAcexwwiyPxx5bpDAChpgWWWpbNQB99kvLEFLopssxfWgISUkp9l6CM5JWeI5HWCoqsh22GxB8uGoa7TEGnA/R7mO/shSumpQ6IQd/g/Olqt2ZDuImppHNP+5rMimlOMBx12In6a6QK0t+aL1CqVk24PcKXAnFSG0KRW7Cc65b1u3Nf1mL9Tu513hkp7SwWk6PKF8g9sZi3nR59YXuExj7lL2NM9RXWdz4CYrWuQMsFlRH1LOAqcDJ8sJfMGkwLR6Zg22nWt96Y9Vz6stVuEc0expSA2SDC/35vYjfCcZm4ljydUIpRm5FN3AGlqoyaaaY9mp76rDdmxHsUNRtcRUs8MKvZfuIEGEmRT3LymnkhJ4RwxdjhX/VayUpMT/T0ochRLHGo2S4MopOerKUznZkzk+J6HOyTQAsQ2SAEw9kEAQ34FpCKIYQE8gCYg9jsAIwAlvHPkgsTQmKd7RIX01rchPPCE5qTp6F1meKxDKs2XJIyWjGTM8ecIVzdhuH8uKIktTPkyyXWUU36/RnI+5ZbkNw8RujvnbWYeWDLeJdwcXjaxVSI3kY29JQcOSUreb/uoZ0HWAG2jkJgoFN5EoeNfr98BSIlz4dp5vE9ue6wu0e6DMj+VDuSlY1SezGKRyfBBPQRJxmiCrnd2MwFOOF/SPs3RrKzTZUKfJDg08eZfgydZ4EhJhvxNBy5S73415bEcUv0QbQ2IQhyLOeSCaCdosUfBFVTAGf+9EZ7av6MwyEGjaNS8itNedaD5eTnB0Kz81J/CsN8sJ7NedaD4eKZov4bmkwLcjxftLyvtTylmnzBTVKxHB7SFDHP+OKNsUSoE4lrvfVtp7rY/ApH4Oss9jUlOXPRqRhlz7utR1LFKde4UzproinRSW3SUOz7KnIsdjCdyUHVFnIAlFlQ2g0zuuBgC6APo8jYOs1pdHWsjoCnKevj1WrLTkJdOx15gpQp4a8iESfvzimb7FjTOEZZBsJv0qCPnRWE7VEo09kWiq5wNtsV1PeukM18s+leynl9FI6WVr40RZE9buAvG5ZhKgSqgQ2CzjMxWeZaP2nt599FDP4ufeNh7d5C8XPQzXJzmq6QPNCnyC3E6XUYXr7Bd6FKY4mWs+efE6fgL8O25rQ0ndfDU7uFecrio38IeEGC5HgpFE5eqiahzb3Y5cazBzXWX5GoKZN5bbDXcdr0pRBmFJhjo1LA1Cnx7vPkSmEyoc2efGqvBI0LvgJ0T9xD3fVNzDjaq+XbOoPCWjtA2xbDRR6d+k9o6/hn1C9e1bXqK7hm9LMu1eECG0zrHBfxvSVtw2LuCXtnaw3nWV+1RdWslaQNdK04DNMOs6WWIk6+u/3z5pFpTbfVN39r4BKrgCysd6LS2qdtQ26sZonpdjtNXcWBt7fAb8JvtFN4iVa+x4axqolxbpnW5uemjDW2vtWgPSrT0Ujefoogktg2rUDeIE1bDH7t+Hmp2j+x8td/ob&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><path d="M 183 273 L 183 39.37" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 183 34.12 L 186.5 41.12 L 183 39.37 L 179.5 41.12 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 183 273 L 736.63 273" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 741.88 273 L 734.88 276.5 L 736.63 273 L 734.88 269.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 183 273 L 343 113" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 343 113 L 463 113" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><rect x="143" y="3" width="80" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 13px; margin-left: 144px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">桶中的令牌数</div></div></div></foreignObject><text x="183" y="17" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">桶中的令牌数</text></switch></g><rect x="703" y="283" width="80" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 293px; margin-left: 704px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">时间</div></div></div></foreignObject><text x="743" y="297" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">时间</text></switch></g><rect x="3" y="93" width="170" height="40" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 168px; height: 1px; padding-top: 113px; margin-left: 5px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">max_token_num (令牌桶容量)</div></div></div></foreignObject><text x="5" y="117" fill="#000000" font-family="Helvetica" font-size="12px">max_token_num (令牌桶容量)</text></switch></g><rect x="253" y="213" width="150" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 223px; margin-left: 254px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">斜率: rate (令牌产生速度)</div></div></div></foreignObject><text x="328" y="227" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">斜率: rate (令牌产生速度)</text></switch></g><path d="M 463 113 L 503 113" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 503 193 L 583 113" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 503 193 L 503 113" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 343 114 L 183 114" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"/><path d="M 583 113 L 743 113" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><rect x="223" y="63" width="190" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 188px; height: 1px; padding-top: 73px; margin-left: 224px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">没有请求的情况下<br />桶中令牌一直堆积直到最大容量</div></div></div></foreignObject><text x="318" y="77" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">没有请求的情况下&#xa;桶中令牌一直堆积直到最大容量</text></switch></g><path d="M 503 273 L 503 196" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 3" pointer-events="stroke"/><ellipse cx="503" cy="193" rx="3" ry="3" fill="none" stroke="#000000" pointer-events="all"/><rect x="468" y="283" width="60" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 293px; margin-left: 498px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">last_time</div></div></div></foreignObject><text x="498" y="297" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">last_time</text></switch></g><rect x="433" y="163" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 173px; margin-left: 434px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">last_token_num</div></div></div></foreignObject><text x="453" y="177" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">last_t...</text></switch></g><path d="M 573 126 L 573 273" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 1" pointer-events="stroke"/><ellipse cx="573" cy="123" rx="3" ry="3" fill="none" stroke="#000000" pointer-events="all"/><rect x="543" y="83" width="40" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 93px; margin-left: 544px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">current_tokenNum</div></div></div></foreignObject><text x="563" y="97" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">curren...</text></switch></g><rect x="543" y="283" width="80" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 293px; margin-left: 583px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">current_time</div></div></div></foreignObject><text x="583" y="297" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">current_time</text></switch></g><rect x="93" y="333" width="700" height="60" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 698px; height: 1px; padding-top: 363px; margin-left: 94px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font style="font-size: 16px"><i>current_tokenNum</i> = MIN(<i>max_token_num</i>,  <i> last_token_num</i> + <i>rate</i> * (<i>current_time</i> - <i>last_time</i>))</font></div></div></div></foreignObject><text x="443" y="367" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">current_tokenNum = MIN(max_token_num,   last_token_num + rate * (current_time - last_time))</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>